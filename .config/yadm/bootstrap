#!/usr/bin/env pwsh -NoProfile

# Source env
. $HOME/.config/powershell/env.ps1

# This hides files we don't want visible in $HOME, but want in the repo nontheless.
Set-Location "$HOME"
yadm submodule update --recursive --init
yadm gitconfig core.sparseCheckout true
yadm sparse-checkout set --no-cone '/*' '!README.md' '!LICENSE' '!.gitmodules' '!Dockerfile' '!prompt-*.png'

# Add some of the XDG directories
mkdir -p "$XDG_CONFIG_HOME" "$XDG_DATA_HOME" "$XDG_STATE_HOME" "$XDG_CACHE_HOME"

# Execute tool-specific bootstrap scripts
Get-ChildItem "$XDG_CONFIG_HOME/*/bootstrap.sh" | Foreach-Object {
	&$_.FullName
}